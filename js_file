let xp = 0;
let health = 100;
let gold = 50;
let monsterHealth = -1;
let inventory = ["fist"];
let buyCount = 0;
let injury = 0;
let attackStrength = 0;
let enterAmount = 0;
const storeItems = ["Club","Magic Claws","Mithril Sword"];
const button1 = document.querySelector("#button1");
const button2 = document.querySelector("#button2");
const button3 = document.querySelector("#button3");
const text = document.querySelector("#text");
const xpText = document.querySelector("#xpText");
const healthText = document.querySelector("#healthText");
const goldText = document.querySelector("#goldText");
const monsterStats = document.querySelector("#monsterStats");
const monsterName = document.querySelector("#monsterName");
const monsterHealthText = document.querySelector("#monsterHealth");


button1.onclick = goStore
button2.onclick = goCave
button3.onclick = fightDragon

function goTownRestart(){

    img_random = Math.floor(Math.random()*3)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/townsquare.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/townsquare.jpeg)"
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/townsquare.jpeg)"
    }

    gold = 50;
    health = 100;
    monsterHealth = -1;
    enterAmount = 0;
    button1.innerText = "Go to store";
    button2.innerText = "Go to cave";
    button3.innerText = "Fight dragon";
    document.getElementById("monsterStats").style.display = "none";
    button1.onclick = goStore;
    button2.onclick = goCave;
    button3.onclick = fightDragon;
    text.innerText = "Welcome to Dragon Repeller. You must defeat the dragon that is preventing people from leaving the town. You are in the town square. Where do you want to go? Use the buttons above.";
    button3.style.display = "initial";
    button2.style.display = "initial";
    document.getElementById("healthText").innerText = health;
    document.getElementById("goldText").innerText = gold;
    inventory = ["fist"];
    buyCount = 0;
}

function goTown() {

    img_random = Math.floor(Math.random()*3)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/townsquare.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/townsquare.jpeg)"
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/townsquare.jpeg)"
    }

    monsterHealth = -1;
    enterAmount = 0;
    button1.innerText = "Go to store";
    button2.innerText = "Go to cave";
    button3.innerText = "Fight dragon";
    document.getElementById("monsterStats").style.display = "none";
    button1.onclick = goStore;
    button2.onclick = goCave;
    button3.onclick = fightDragon;
    text.innerText = "You are in the town square. You see a sign that says Store.";
}

function goStore() {

    img_random = Math.floor(Math.random()*3)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/store_heal.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/store_heal1.jpeg)"
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/store_weapon_3.jpeg)"
    }
    
    
    button1.innerText = "Buy 10 health (10 gold)";
    button2.innerText = "Upgrade weapon (100 gold)";
    button3.innerText = "Go to town square";
    text.innerText = "You have entered the store. What do you want to do?";
    button1.onclick = buyHealth;
    button2.onclick = buyWeapon;
    button3.onclick = goTown;
}
function goCave() {

    img_random = Math.floor(Math.random()*3)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/dungeon1.jpeg)";
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/dungeon1.jpeg)";
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/dungeon1.jpeg)";
    }

    button1.innerText = "Fight Slime";
    button2.innerText = "Fight Wolf";
    button3.innerText = "Go to town";
    text.innerText = "You have entered the cave. Select your action?";
    button1.onclick = fightSlime;
    button2.onclick = fightWolf;
    button3.onclick = goTown;
}
function fightDragon() {

    img_random = Math.floor(Math.random()*4)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/dragon.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/dragon1.jpeg)"
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/dragon2.jpeg)"
    }
    if(img_random==3){
        document.getElementById("image_").style.backgroundImage = "url(Images/dragon3.jpeg)"
    }

    button1.innerText = "Attack";
    button2.innerText = "Dodge";
    button3.innerText = "Run";
    text.innerText = "You are fighting the dragon.";
    button1.onclick = attackedDragon;
    button2.onclick = Dodge;
    button3.onclick = goTown;
    document.getElementById("monsterStats").style.display = "flex";
    document.getElementById("monsterName").innerText ="Dragon";
    document.getElementById("monsterHealth").innerText = "500";
}
function fightWolf(){

    img_random = Math.floor(Math.random()*4)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_wolf.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_wolf1.jpeg)"
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_wolf2.jpeg)"
    }
    if(img_random==3){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_wolf3.jpeg)"
    }

    button1.innerText = "Attack";
    button2.innerText = "Dodge";
    button3.innerText = "Run";
    button1.onclick = attackedWolf;
    button2.onclick = Dodge;
    button3.onclick = goTown;
    text.innerText = "You are fighting the wolf.";
    document.getElementById("monsterStats").style.display = "flex";
    document.getElementById("monsterName").innerText ="Wolf";
    document.getElementById("monsterHealth").innerText = "70";
}
function fightSlime() {

    img_random = Math.floor(Math.random()*4)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_slime.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_slime1.jpeg)"
    }
    if(img_random==2){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_slime.jpeg)"
    }
    if(img_random==3){
        document.getElementById("image_").style.backgroundImage = "url(Images/cave_slime1.jpeg)"
    }

    button1.innerText = "Attack";
    button2.innerText = "Dodge";
    button3.innerText = "Run";
    button1.onclick = attackedSlime;
    button2.onclick = Dodge;
    button3.onclick = goTown;
    text.innerText = "You are fighting the slime.";
    document.getElementById("monsterStats").style.display = "flex";
    document.getElementById("monsterName").innerText ="Slime";
    document.getElementById("monsterHealth").innerText = "20";
}

function buyHealth(){
    if (gold-10 >=0){
    health = health + 10;
    gold = gold - 10;}
    else {
        text.innerText = "You don't have enough gold to increase health.";}
    goldText.innerText = gold; 
    healthText.innerText = health;
}
function buyWeapon(){
    if(gold-100 >=0){
        if(buyCount==3){
            text.innerText ="You already have maxed out weapon."
        } 
        else{ 
        inventory[0] = storeItems[buyCount]
    text.innerText = "You have upgraded your weapon. Your are now using " + inventory[0] + ".";
    gold = gold - 100;
    buyCount += 1;
    goldText.innerText = gold;}}
    else{
    text.innerText = "You don't have enough gold to upgrade your weapon.";
}}
function Dodge(){
    text.innerText = "You have dodged the attack."
}
function attackedDragon(){
    if (buyCount == 0){
        attackStrength = Math.floor(Math.random()*9);
    }
    if (buyCount == 1){
        attackStrength = Math.floor(Math.random()*20)+2;
    }
    if (buyCount == 2){
        attackStrength = Math.floor(Math.random()*41)+15;
    }
    if (buyCount == 3){
        attackStrength = Math.floor(Math.random()*56)+40;
    }
    injury = Math.floor(Math.random()*56+30)
    if (monsterHealth > 0){
        monsterHealth = monsterHealth - attackStrength;
        health = health - injury;
        document.getElementById("healthText").innerText = health;
        text.innerText = "You have attacked the dragon, inflicting " + attackStrength + " damage. Dragon attacked you, inflicting " + injury + " damage.";
        document.getElementById("monsterHealth").innerText = monsterHealth;
        }
    if(monsterHealth <= 0){
        enterAmount += 1;
    if (enterAmount == 1){
        health = health - injury;
        document.getElementById("healthText").innerText = health;
        monsterHealth = 500 - attackStrength;
        text.innerText = "You have attacked the dragon, inflicting " + attackStrength + " damage. Dragon attacked you, inflicting " + injury + " damage.";
        document.getElementById("monsterHealth").innerText = monsterHealth;}
    else{
        document.getElementById("monsterHealth").innerText = "None";
        text.innerText = "You have attacked the dragon, inflicting " + attackStrength + " damage. Dragon attacked you, inflicting " + injury + " damage. You have defeated the monster.";
        monsterHealth = -1;
        enterAmount = 0;
        gold += 20;
        goldText.innerText = gold;
        button1.innerText = "Continue";
        button2.style.display = "None";
        button3.style.display = "None";
        button1.onclick = WIN;
}}
if(health < 40){
    document.getElementById("healthText").style.color = "red";
}
if(health <=0){
    text.innerText="You have attacked the dragon, inflicting " + attackStrength + " damage. Dragon attacked you, inflicting " + injury + " damage. \nGame Over!!!"
    document.getElementById("healthText").innerText = "None";
    document.getElementById("goldText").innerText = "None";
    button1.innerText = "Restart";
    button3.style.display = "None";
    button2.style.display = "None";
    button1.onclick = goTownRestart
}}
function WIN(){
    button1.innerText = "Restart"
    text.innerText = "You have defeated the dragon. The villagers are grateful to you. Let's meet again in a new adventure."
    button1.onclick = goTownRestart
}
function attackedSlime(){
    if (buyCount == 0){
        attackStrength = Math.floor(Math.random()*21);
    }
    if (buyCount == 1){
        attackStrength = Math.floor(Math.random()*26)+10;
    }
    if (buyCount == 2){
        attackStrength = Math.floor(Math.random()*50)+20;
    }
    if (buyCount == 3){
        attackStrength = Math.floor(Math.random()*101)+50;
    }
    injury = Math.floor(Math.random()*16)
    if (monsterHealth > 0){
        monsterHealth = monsterHealth - attackStrength;
        health = health - injury;
        document.getElementById("healthText").innerText = health;
        text.innerText = "You have attacked the slime, inflicting " + attackStrength + " damage. Slime attacked you, inflicting " + injury + " damage.";
        document.getElementById("monsterHealth").innerText = monsterHealth;
        }
    if(monsterHealth <= 0){
        enterAmount += 1;
    if (enterAmount == 1){
        health = health - injury;
        document.getElementById("healthText").innerText = health;
        monsterHealth = 20 - attackStrength;
        text.innerText = "You have attacked the slime, inflicting " + attackStrength + " damage. Slime attacked you, inflicting " + injury + " damage.";
        document.getElementById("monsterHealth").innerText = monsterHealth;
}
    if(monsterHealth <=0){
        document.getElementById("monsterHealth").innerText = "None";
        text.innerText = "You have attacked the slime, inflicting " + attackStrength + " damage. Slime attacked you, inflicting " + injury + " damage. You have defeated the monster.";
        monsterHealth = -1;
        enterAmount = 0;
        gold += 30;
        goldText.innerText = gold;
        button1.innerText = "Fight another slime";
        button2.innerText = "Fight wolf";
        button3.innerText = "Return to town";
        button1.onclick = fightSlime;
        button2.onclick = fightWolf;
        button3.onclick = goTown;
}}
if(health < 40){
    document.getElementById("healthText").style.color = "red";
}
if(health <=0){

    img_random = Math.floor(Math.random()*2)
    if(img_random==0){
        document.getElementById("image_").style.backgroundImage = "url(Images/death_slime.jpeg)"
    }
    if(img_random==1){
        document.getElementById("image_").style.backgroundImage = "url(Images/death_slime1.jpeg)"
    }

    text.innerText="You have attacked the slime, inflicting " + attackStrength + " damage. Slime attacked you, inflicting " + injury + " damage. \nGame Over!!!"
    document.getElementById("healthText").innerText = "None";
    document.getElementById("goldText").innerText = "None";
    button1.innerText = "Restart";
    button3.style.display = "None";
    button2.style.display = "None";
    button1.onclick = goTownRestart
}}
function attackedWolf(){
    if (buyCount == 0){
        attackStrength = Math.floor(Math.random()*11);
    }
    if (buyCount == 1){
        attackStrength = Math.floor(Math.random()*26)+8;
    }
    if (buyCount == 2){
        attackStrength = Math.floor(Math.random()*50)+15;
    }
    if (buyCount == 3){
        attackStrength = Math.floor(Math.random()*100)+35;
    }
    injury = Math.floor(Math.random()*46)
    if (monsterHealth > 0){
        monsterHealth = monsterHealth - attackStrength;
        health = health - injury;
        document.getElementById("healthText").innerText = health;
        text.innerText = "You have attacked the Wolf, inflicting " + attackStrength + " damage. Wolf attacked you, inflicting " + injury + " damage.";
        document.getElementById("monsterHealth").innerText = monsterHealth;
        }
    if(monsterHealth <= 0){
        enterAmount += 1;
    if (enterAmount == 1){
        health = health - injury;
        document.getElementById("healthText").innerText = health;
        monsterHealth = 70 - attackStrength;
        text.innerText = "You have attacked the wolf, inflicting " + attackStrength + " damage. Wolf attacked you, inflicting " + injury + " damage.";
        document.getElementById("monsterHealth").innerText = monsterHealth;
}
    if(monsterHealth <=0){
        document.getElementById("monsterHealth").innerText = "None";
        text.innerText = "You have attacked the wolf, inflicting " + attackStrength + " damage. Wolf attacked you, inflicting " + injury + " damage. You have defeated the monster.";
        monsterHealth = -1;
        enterAmount = 0;
        gold += 80;
        goldText.innerText = gold;
        button1.innerText = "Fight slime";
        button2.innerText = "Fight another wolf";
        button3.innerText = "Return to town";
        button1.onclick = fightSlime;
        button2.onclick = fightWolf;
        button3.onclick = goTown;
}}
if(health < 40){
    document.getElementById("healthText").style.color = "red";
}
if(health <=0){
    text.innerText="You have attacked the wolf, inflicting " + attackStrength + " damage. Wolf attacked you, inflicting " + injury + " damage. \nGame Over!!!"
    document.getElementById("healthText").innerText = "None";
    document.getElementById("goldText").innerText = "None";
    button1.innerText = "Restart";
    button3.style.display = "None";
    button2.style.display = "None";
    button1.onclick = goTownRestart
}}
